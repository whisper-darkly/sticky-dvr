# sticky-dvr â€” Thumbnailer (sticky-thumbnailer image)
# Generates thumbnail images from recording files.
# Config file at ${CONFIG_DIR}/thumbnailer-config.yaml.
#
# Usage:
#   docker compose -f deploy/compose/thumbnailer.yaml --env-file deploy/.env up -d

services:
  thumbnailer:
    image: sticky-thumbnailer:latest
    restart: unless-stopped
    volumes:
      - ${CONFIG_DIR}/thumbnailer-config.yaml:/data/config.yaml:ro
      - ${RECORDINGS_DIR}:/recordings
      - ${DATA_DIR}/thumbnailer:/data
    healthcheck:
      test: ["CMD", "wget", "-q", "--spider", "http://localhost:8080/openapi.json"]
      start_period: 10s
      interval: 15s
      timeout: 5s
      retries: 3
    networks:
      - sticky-dvr

networks:
  sticky-dvr:
    external: true
