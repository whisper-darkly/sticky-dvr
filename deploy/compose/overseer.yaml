# sticky-dvr â€” Overseer / Recorder (sticky-recorder image)
# Manages recording worker processes.
# Config file at ${CONFIG_DIR}/overseer-config.yaml.
#
# Usage:
#   docker compose -f deploy/compose/overseer.yaml --env-file deploy/.env up -d

services:
  overseer:
    image: sticky-recorder:latest
    restart: unless-stopped
    volumes:
      - ${CONFIG_DIR}/overseer-config.yaml:/etc/sticky-overseer/config.yaml:ro
      - ${DATA_DIR}/overseer:/data
      - ${RECORDINGS_DIR}:/data/recordings
    healthcheck:
      test: ["CMD-SHELL", "wget -qSO- http://localhost:8080/ws 2>&1 | grep -q '400 Bad Request'"]
      start_period: 10s
      interval: 15s
      timeout: 5s
      retries: 3
    networks:
      - sticky-dvr

networks:
  sticky-dvr:
    external: true
