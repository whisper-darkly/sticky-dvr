# sticky-recorder overseer config â€” production
# Mounted at: /etc/sticky-overseer/config.yaml inside the overseer container

name: "sticky-recorder"
listen: ":8080"
db: /data/overseer.db

task_pool:
  limit: 8
  queue:
    enabled: true
    size: 100

actions:
  chaturbate:
    type: exec
    dedupe_key: ["source"]
    retry:
      restart_delay: "30s"
      error_threshold: 0
      error_window: "0s"
    config:
      entrypoint: sticky-recorder
      command:
        - "-d"
        - "chaturbate"
        - "-s"
        - "[[.source]]"
        - "-r"
        - "[[.resolution]]"
        - "-f"
        - "[[.framerate]]"
        - "-c"
        - "[[.cookies]]"
        - "-a"
        - "[[.user_agent]]"
        - "-o"
        - "[[.out]]"
        - "-i"
        - "[[.check_interval]]"
        - "-l"
        - "[[.segment_length]]"
        - "--heartbeat-interval"
        - "[[.heartbeat_interval]]"
        - "--output-format"
        - "json"
      parameters:
        source: {}
        out: {}
        resolution:
          default: "720"
          validate: 'value in ["480", "720", "1080"]'
        framerate:
          default: "30"
          validate: 'value in ["30", "60"]'
        cookies:
          default: ""
        user_agent:
          default: ""
        check_interval:
          default: "1m"
        segment_length:
          default: "0"
        heartbeat_interval:
          default: "30s"
      output:
        stdout:
          condition: "has(output.json.event)"
        stderr:
          condition: "false"

  stripchat:
    type: exec
    dedupe_key: ["source"]
    retry:
      restart_delay: "30s"
      error_threshold: 0
      error_window: "0s"
    config:
      entrypoint: sticky-recorder
      command:
        - "-d"
        - "stripchat"
        - "-s"
        - "[[.source]]"
        - "-r"
        - "[[.resolution]]"
        - "-f"
        - "[[.framerate]]"
        - "-c"
        - "[[.cookies]]"
        - "-a"
        - "[[.user_agent]]"
        - "-o"
        - "[[.out]]"
        - "-i"
        - "[[.check_interval]]"
        - "-l"
        - "[[.segment_length]]"
        - "--heartbeat-interval"
        - "[[.heartbeat_interval]]"
        - "--output-format"
        - "json"
      parameters:
        source: {}
        out: {}
        resolution:
          default: "720"
          validate: 'value in ["480", "720", "1080"]'
        framerate:
          default: "30"
          validate: 'value in ["30", "60"]'
        cookies:
          default: ""
        user_agent:
          default: ""
        check_interval:
          default: "1m"
        segment_length:
          default: "0"
        heartbeat_interval:
          default: "30s"
      output:
        stdout:
          condition: "has(output.json.event)"
        stderr:
          condition: "false"
